#
# CFLAGS must include -DDOUBLE_BYTE_ORDER= 1 or 2.
#
CC=gcc
ifeq ($(shell arch),sun4)
LIBES=-lsocket -lnsl
CFLAGS=-DDOUBLE_BYTE_ORDER=1 -DUSE_SIGSET -g -Wall
endif
ifeq ($(shell arch),i686)
CFLAGS=-DDOUBLE_BYTE_ORDER=2 -g -Wall
endif

all:	client server client2 attack net_redir set_stack_offset

rpc.o rpc_service.o:		rpc.h

server.o:	rpc_service.h

server:		server.o rpc_service.o rpc.o
	$(CC) -o $@ server.o rpc_service.o rpc.o $(LIBES)

client:		client.o rpc.o
	$(CC) -o $@ client.o rpc.o $(LIBES)

client2:	client2.o rpc.o
	$(CC) -o $@ client2.o rpc.o $(LIBES)

attack:	attack.o rpc.o
	$(CC) -o $@ attack.o rpc.o $(LIBES)

net_redir:	net_redir.c
	$(CC) -o $@ $(CFLAGS) net_redir.c $(LIBES)

clean:
	rm -f *.o *~ core client client2 badclient server net_redir set_stack_offset a.out

.PHONY:	clean all
